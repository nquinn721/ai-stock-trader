# ADR-006: Transition from Mock Data to Real-Time Data Integration

## Status

Accepted

## Context

The Stock Trading App initially used mock data for development to avoid database hanging issues and external API dependencies. However, to provide accurate trading simulations and real-world functionality, we needed to integrate with real data sources and persistent storage.

## Decision

We have transitioned from mock data to real-time data integration with the following components:

### Real Data Sources

- **Yahoo Finance API**: Primary source for real-time stock prices, historical data, and market information
- **Database Persistence**: MySQL with TypeORM for storing trading signals, portfolios, and user data
- **AI/ML Models**: Real machine learning analysis for trading signal generation

### Data Architecture

- **Stock Prices**: Fetched in real-time from Yahoo Finance API
- **Trading Signals**: Generated by AI models and persisted to database
- **Historical Data**: Retrieved from Yahoo Finance for technical analysis
- **Portfolio Data**: Stored in database for paper trading functionality

### Integration Components

- **TypeORM**: Enabled for database operations and entity management
- **WebSocket**: Real-time price updates pushed to frontend clients
- **Caching**: Strategic caching to respect API rate limits
- **Error Handling**: Robust error handling for external API failures

### Removed Mock Components

- Mock stock price generation
- Simulated trading signals
- In-memory data storage
- Static market data

## Consequences

### Positive

- **Accurate Data**: Real market prices and conditions for realistic trading simulations
- **Production Ready**: Development environment mirrors production data architecture
- **Real-time Updates**: Live price feeds and instant signal generation
- **Persistent Storage**: Reliable data persistence for user portfolios and trading history
- **Scalable Architecture**: Production-ready data handling and API integration

### Negative

- **External Dependencies**: Reliance on Yahoo Finance API availability
- **Network Requirements**: Internet connection required for stock data
- **Rate Limiting**: Must respect Yahoo Finance API rate limits
- **Database Setup**: Requires MySQL database configuration
- **Complexity**: Increased system complexity with real integrations

### Migration Impact

- **Configuration**: Database connection strings and API keys required
- **Testing**: More complex testing scenarios with external dependencies
- **Error Handling**: Enhanced error handling for network and API failures
- **Performance**: Consideration of API response times and caching strategies

## Implementation Notes

- Yahoo Finance API integration via `yahoo-finance2` npm package
- TypeORM synchronization enabled for automatic schema management
- WebSocket gateway for real-time price distribution
- Graceful fallback handling for API failures
- Monitoring and logging for external API interactions
- Rate limiting protection to prevent API quota exhaustion

## Migration Checklist

- [x] Install and configure `yahoo-finance2` package
- [x] Enable TypeORM in app.module.ts
- [x] Update stock service to fetch real data
- [x] Implement WebSocket for real-time updates
- [x] Configure database connection in .env
- [x] Update trading signal generation with real data
- [x] Remove mock data services and methods
- [x] Update documentation to reflect real data usage
- [x] Test API error handling and fallback scenarios
